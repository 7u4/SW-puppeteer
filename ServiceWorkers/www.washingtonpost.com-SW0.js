(function(){self.addEventListener("install",function(event){event.waitUntil(caches.open("firebase-messaging-07202018").then(function(cache){return cache.add("/resources/js/firebase/firebase.js")}))});self.addEventListener("fetch",function(event){if(event.request.method==="GET"&&/(\/pb)?\/resources\/js\/firebase\/firebase\.js/.test(event.request.url))event.respondWith(caches.match(event.request).then(function(response){return response||fetch(event.request)}))});self.importScripts("/resources/js/firebase/firebase.js");
var icon="https://www.washingtonpost.com/wp-stat/desktop-notifications/icons/wp-icon-108.png";var devConfig={messagingSenderId:"948590696263"};var prodConfig={messagingSenderId:"336517036152"};var pbHost=location.host;var isProd=/^(washingtonpost|pb-impact(-origin)?)\.?(wpprivate|washingtonpost)?\.com/.test(pbHost);firebase.initializeApp(isProd?prodConfig:devConfig);var messaging=firebase.messaging();messaging.setBackgroundMessageHandler(function(payload){console.log("Received background message ",
payload);var notificationTitle="Breaking News";var notificationOptions={body:payload.data.message,icon:icon,data:payload.data.url};return self.registration.showNotification(notificationTitle,notificationOptions)});self.addEventListener("notificationclick",function(event){var contentURL=event.notification.data;if(contentURL.indexOf("?")>-1)contentURL+="\x26tidr\x3dnotifi_push_breaking-news";else contentURL+="?tidr\x3dnotifi_push_breaking-news";event.notification.close();event.waitUntil(self.clients.openWindow(contentURL))})})();